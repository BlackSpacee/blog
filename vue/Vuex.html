<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vuex | Sunny</title>
    <meta name="description" content="记录生活,vuepress,web前端,技术博客,技术分享">
    <meta name="generator" content="VuePress 1.3.1">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/assets/css/0.styles.c8a60675.css" as="style"><link rel="preload" href="/assets/js/app.da8279db.js" as="script"><link rel="preload" href="/assets/js/2.09c1df90.js" as="script"><link rel="preload" href="/assets/js/65.37f298d6.js" as="script"><link rel="preload" href="/assets/js/3.c0db3266.js" as="script"><link rel="prefetch" href="/assets/js/10.792c9595.js"><link rel="prefetch" href="/assets/js/11.ad956743.js"><link rel="prefetch" href="/assets/js/12.d9b45204.js"><link rel="prefetch" href="/assets/js/13.06bdfee6.js"><link rel="prefetch" href="/assets/js/14.eba37fb9.js"><link rel="prefetch" href="/assets/js/15.cbc381f4.js"><link rel="prefetch" href="/assets/js/16.43b2ce6d.js"><link rel="prefetch" href="/assets/js/17.701430d8.js"><link rel="prefetch" href="/assets/js/18.3e3227f3.js"><link rel="prefetch" href="/assets/js/19.25458a06.js"><link rel="prefetch" href="/assets/js/20.05942889.js"><link rel="prefetch" href="/assets/js/21.1f501939.js"><link rel="prefetch" href="/assets/js/22.16ef9af4.js"><link rel="prefetch" href="/assets/js/23.97537190.js"><link rel="prefetch" href="/assets/js/24.f4e42b6b.js"><link rel="prefetch" href="/assets/js/25.b2f33d75.js"><link rel="prefetch" href="/assets/js/26.74a50450.js"><link rel="prefetch" href="/assets/js/27.69251278.js"><link rel="prefetch" href="/assets/js/28.a672144c.js"><link rel="prefetch" href="/assets/js/29.6263a2fd.js"><link rel="prefetch" href="/assets/js/30.2e794242.js"><link rel="prefetch" href="/assets/js/31.c616e1f1.js"><link rel="prefetch" href="/assets/js/32.54261b92.js"><link rel="prefetch" href="/assets/js/33.1c61b40e.js"><link rel="prefetch" href="/assets/js/34.d03a008d.js"><link rel="prefetch" href="/assets/js/35.0c6517e0.js"><link rel="prefetch" href="/assets/js/36.9a59e2fa.js"><link rel="prefetch" href="/assets/js/37.0da503b5.js"><link rel="prefetch" href="/assets/js/38.e35ba786.js"><link rel="prefetch" href="/assets/js/39.985e47a3.js"><link rel="prefetch" href="/assets/js/4.64f8a00c.js"><link rel="prefetch" href="/assets/js/40.6060fdbb.js"><link rel="prefetch" href="/assets/js/41.b894ba43.js"><link rel="prefetch" href="/assets/js/42.f73d37bc.js"><link rel="prefetch" href="/assets/js/43.4a91b340.js"><link rel="prefetch" href="/assets/js/44.c35891d4.js"><link rel="prefetch" href="/assets/js/45.5956063c.js"><link rel="prefetch" href="/assets/js/46.15ecb34c.js"><link rel="prefetch" href="/assets/js/47.967a13e5.js"><link rel="prefetch" href="/assets/js/48.edccff42.js"><link rel="prefetch" href="/assets/js/49.63f043a1.js"><link rel="prefetch" href="/assets/js/5.f6966e72.js"><link rel="prefetch" href="/assets/js/50.dda6c6c4.js"><link rel="prefetch" href="/assets/js/51.3cc13e49.js"><link rel="prefetch" href="/assets/js/52.044ff865.js"><link rel="prefetch" href="/assets/js/53.844f8ff1.js"><link rel="prefetch" href="/assets/js/54.5cf351e9.js"><link rel="prefetch" href="/assets/js/55.ac9f233f.js"><link rel="prefetch" href="/assets/js/56.2a8029ef.js"><link rel="prefetch" href="/assets/js/57.fc4774e0.js"><link rel="prefetch" href="/assets/js/58.bafc5295.js"><link rel="prefetch" href="/assets/js/59.b4ce9c07.js"><link rel="prefetch" href="/assets/js/6.1d31d62f.js"><link rel="prefetch" href="/assets/js/60.a1370413.js"><link rel="prefetch" href="/assets/js/61.178fb243.js"><link rel="prefetch" href="/assets/js/62.88c09f00.js"><link rel="prefetch" href="/assets/js/63.93b7be73.js"><link rel="prefetch" href="/assets/js/64.cb833996.js"><link rel="prefetch" href="/assets/js/66.58ce4375.js"><link rel="prefetch" href="/assets/js/67.f63ce476.js"><link rel="prefetch" href="/assets/js/68.e8f43c7e.js"><link rel="prefetch" href="/assets/js/7.786c12d1.js"><link rel="prefetch" href="/assets/js/8.c26d80ae.js"><link rel="prefetch" href="/assets/js/9.911fcd57.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c8a60675.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Sunny</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue.js Menu" class="dropdown-title"><span class="title">Vue.js</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/Vue.js.html" class="nav-link">
  Vue.js
</a></li><li class="dropdown-item"><!----> <a href="/vue/VueRouter/" class="nav-link">
  Vue-Router
</a></li><li class="dropdown-item"><!----> <a href="/vue/Vuex/" class="nav-link">
  Vuex
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="React Menu" class="dropdown-title"><span class="title">React</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/react/redux/" class="nav-link">
  Redux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CSS Menu" class="dropdown-title"><span class="title">CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/css3/css3/" class="nav-link">
  css3
</a></li><li class="dropdown-item"><!----> <a href="/百分比/百分比/" class="nav-link">
  流式布局
</a></li><li class="dropdown-item"><!----> <a href="/rem/rem/" class="nav-link">
  rem
</a></li><li class="dropdown-item"><!----> <a href="/flex/flex/" class="nav-link">
  flex
</a></li><li class="dropdown-item"><!----> <a href="/less/less/" class="nav-link">
  Less
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript Menu" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/jQuery/jQuery/" class="nav-link">
  jQuery
</a></li><li class="dropdown-item"><!----> <a href="/ES6/起步.html" class="nav-link">
  ES6文档
</a></li></ul></div></div><div class="nav-item"><a href="/notes/" class="nav-link">
  notes
</a></div><div class="nav-item"><a href="/mine/" class="nav-link">
  blog
</a></div> <a href="https://github.com/zhongyongfeng/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue.js Menu" class="dropdown-title"><span class="title">Vue.js</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue/Vue.js.html" class="nav-link">
  Vue.js
</a></li><li class="dropdown-item"><!----> <a href="/vue/VueRouter/" class="nav-link">
  Vue-Router
</a></li><li class="dropdown-item"><!----> <a href="/vue/Vuex/" class="nav-link">
  Vuex
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="React Menu" class="dropdown-title"><span class="title">React</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/react/react/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/react/redux/" class="nav-link">
  Redux
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="CSS Menu" class="dropdown-title"><span class="title">CSS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/css3/css3/" class="nav-link">
  css3
</a></li><li class="dropdown-item"><!----> <a href="/百分比/百分比/" class="nav-link">
  流式布局
</a></li><li class="dropdown-item"><!----> <a href="/rem/rem/" class="nav-link">
  rem
</a></li><li class="dropdown-item"><!----> <a href="/flex/flex/" class="nav-link">
  flex
</a></li><li class="dropdown-item"><!----> <a href="/less/less/" class="nav-link">
  Less
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JavaScript Menu" class="dropdown-title"><span class="title">JavaScript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/jQuery/jQuery/" class="nav-link">
  jQuery
</a></li><li class="dropdown-item"><!----> <a href="/ES6/起步.html" class="nav-link">
  ES6文档
</a></li></ul></div></div><div class="nav-item"><a href="/notes/" class="nav-link">
  notes
</a></div><div class="nav-item"><a href="/mine/" class="nav-link">
  blog
</a></div> <a href="https://github.com/zhongyongfeng/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/vue/Vuex.html" class="active sidebar-link">Vuex</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/Vuex.html#起步" class="sidebar-link">起步</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#单页面状态管理" class="sidebar-link">单页面状态管理</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#vuex状态管理图例" class="sidebar-link">Vuex状态管理图例</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#vuex核心概念" class="sidebar-link">Vuex核心概念</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/Vuex.html#state单一状态树" class="sidebar-link">state单一状态树</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#getters基本使用" class="sidebar-link">Getters基本使用</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#getters传参" class="sidebar-link">Getters传参</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#mutation状态更新" class="sidebar-link">Mutation状态更新</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#mutation传递参数" class="sidebar-link">Mutation传递参数</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#mutation提交风格" class="sidebar-link">Mutation提交风格</a></li></ul></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#mutation响应规则" class="sidebar-link">Mutation响应规则</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#mutation常量类型" class="sidebar-link">Mutation常量类型</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#mutations同步函数" class="sidebar-link">Mutations同步函数</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#actions" class="sidebar-link">actions</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#module" class="sidebar-link">Module</a></li><li class="sidebar-sub-header"><a href="/vue/Vuex.html#项目结构组织" class="sidebar-link">项目结构组织</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="起步"><a href="#起步" class="header-anchor">#</a> 起步</h2> <div class="custom-block tip"><p class="custom-block-title">Vuex</p> <p>官方解释：Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。</p> <p>它采用 集中式存储管理 应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。</p> <p>Vuex 也集成到 Vue 的官方调试工具 devtools extension，提供了诸如零配置的 time-travel 调试、状态快照导入导出等高级调试功能。</p></div> <div class="custom-block tip"><p class="custom-block-title">状态管理</p> <p>可以简单的将其看成把需要多个组件共享的变量全部存储在一个对象里面。</p> <p>然后，将这个对象放在顶层的Vue实例中，让其他组件可以使用。
那么，多个组件就可以共享这个对象中的所有变量属性</p></div> <p>什么状态需要我们在多个组件间共享?
如果做大型开放，一定遇到过多个状态，在多个界面间的共享问题。
比如用户的登录状态、用户名称、头像、地理位置信息等等。
比如商品的收藏、购物车中的物品等等。
这些状态信息，我们都可以放在统一的地方，对它进行保存和管理，而且它们还是响应式的</p> <h2 id="单页面状态管理"><a href="#单页面状态管理" class="header-anchor">#</a> 单页面状态管理</h2> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200321184239.png" alt=""></p> <div class="custom-block tip"><p class="custom-block-title">单页面状态管理</p> <p>State：不用多说，就是我们的状态。（姑且可以当做就是data中的属性）</p> <p>View：视图层，可以针对State的变化，显示不同的信息.</p> <p>Actions：这里的Actions主要是用户的各种操作：点击、输入等等，会导致状态的改变。</p></div> <p>在项目根目录安装Vuex</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>npm install vuex --save
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在组件文件夹新建一个HeeloVuex.vue,在src文件夹下新建一个store文件夹,新建一个index.js,</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322095003.png" alt=""></p> <p>下载完毕后在main.js下导入vuex</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322094924.png" alt=""></p> <p>在store文件夹下index.js配置Vuex</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322094852.png" alt=""></p> <p>此时的HelloVuex跟App很明显的形成了父子关系,App里面的数据counter,想要在HelloVuex里面用的话,目前还没有什么好的解决方案,只有父传子的通信可以解决,暂且可以不把它们当成父子关系,它们之间是相互独立的房间(兄弟关系),都需要使用counter这个数据(变量)</p> <p>index.js</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322100507.png" alt=""></p> <p>HeeloVuex组件</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322100552.png" alt=""></p> <p>App组件</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322100731.png" alt=""></p> <p>页面展示效果,点击增加和减少App和HelloVuex的内容都会改变,实现了用Vuex的状态管理管理了相同需要的变量couter</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322100834.png" alt=""></p> <p>这就是最基本的Vuex思想,但是这种方式是不好的,Vue官方推出了一个浏览器插件,Devtoods,该工具可以在浏览器端进行调试,但是如果使用了该方法(只修改State状态),该工具就会起不到作用.(不能同步)</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322113048.png" alt=""></p> <h2 id="vuex状态管理图例"><a href="#vuex状态管理图例" class="header-anchor">#</a> Vuex状态管理图例</h2> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322101313.png" alt=""></p> <p>通过Mutations更改State的状态,需要有异步操作的时候需要用到Actions</p> <p>还是刚才的案例</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322111735.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322112109.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322113009.png" alt=""></p> <h2 id="vuex核心概念"><a href="#vuex核心概念" class="header-anchor">#</a> Vuex核心概念</h2> <p><code>State</code> <code>Getters</code> <code>Mutations</code> <code>Actions</code> <code>Module</code></p> <h3 id="state单一状态树"><a href="#state单一状态树" class="header-anchor">#</a> state单一状态树</h3> <p>Vuex提出使用单一状态树, 什么是单一状态树呢？英文名称是Single Source of Truth，也可以翻译成单一数据源。</p> <p>举个例子:
在国内我们有很多的信息需要被记录，比如上学时的个人档案，工作后的社保记录，公积金记录，结婚后的婚姻信息，以及其他相关的户口、医疗、文凭、房产记录等等（还有很多信息）。
这些信息被分散在很多地方进行管理，有一天你需要办某个业务时(比如入户某个城市)，你会发现你需要到各个对应的工作地点去打印、盖章各种资料信息，最后到一个地方提交证明你的信息无误。
这种保存信息的方案，不仅仅低效，而且不方便管理，以及日后的维护也是一个庞大的工作(需要大量的各个部门的人力来维护，当然国家目前已经在完善我们的这个系统了)。</p> <p>在Vuex里面,如果你的状态信息是保存到多个Store对象中的，那么之后的管理和维护等等都会变得特别困难。
所以Vuex也使用了单一状态树来管理应用层级的全部状态。
单一状态树能够让我们最直接的方式找到某个状态的片段，而且在之后的维护和调试过程中，也可以非常方便的管理和维护。</p> <p>简而言之,就是把把所有的状态信息都保存在一个store对象里面</p> <h3 id="getters基本使用"><a href="#getters基本使用" class="header-anchor">#</a> Getters基本使用</h3> <p>类似于组件内的getter属性,用于写计算类的方法</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322140010.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322140222.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322140627.png" alt=""></p> <p>最终页面展示效果如下</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322140949.png" alt=""></p> <h3 id="getters传参"><a href="#getters传参" class="header-anchor">#</a> Getters传参</h3> <p>现在多了一个需求,就是在筛选过后的数据里,要显示学生的个数,此时就可以再定一个getters的方法,more18stuLength,如果还像上面一样用filter筛选数据的话会显得比较麻烦.所以此时可以传递一个参数</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322142216.png" alt=""></p> <p>使用</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322142303.png" alt=""></p> <p>效果</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322142353.png" alt=""></p> <p>如果还像传参,需要用户来判断筛选年龄大于20的学生</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322143623.png" alt=""></p> <p>使用</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;h2&gt;{{$store.getters.moreAgestu(20)}}&lt;/h2&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>效果</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322143552.png" alt=""></p> <h3 id="mutation状态更新"><a href="#mutation状态更新" class="header-anchor">#</a> Mutation状态更新</h3> <p>Vuex的store状态的更新唯一方式：提交Mutation</p> <div class="custom-block tip"><p class="custom-block-title">Mutation主要包括两部分</p> <p>字符串的事件类型（type）(可以理解为函数名字)</p> <p>一个回调函数（handler）,该回调函数的第一个参数就是state(可以理解为函数体)</p></div> <p>mutation的定义方式</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>mutations<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">increment</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        state<span class="token punctuation">.</span>counter<span class="token operator">++</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>通过mutation更新</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">addition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;increment&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="mutation传递参数"><a href="#mutation传递参数" class="header-anchor">#</a> Mutation传递参数</h3> <p>在通过mutation更新数据的时候, 有可能我们希望携带一些额外的参数</p> <p>参数被称为是mutation的载荷(Payload)</p> <p>上面的例子说到增加count变量的数量,减少count变量的数量,getter属性的用途,(平方,筛选学生),现在叕叕叕叕增加了一个需求,需要每次点击按钮,count值+5,+10.这个时候就需要在Mutation传递参数了,如果参数不是一个,并且有多个参数传递,通常以对象的形式传递,也就是说Payload是一个对象(需要添加一个学生进来)</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322154221.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322154701.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322162717.png" alt=""></p> <h3 id="mutation提交风格"><a href="#mutation提交风格" class="header-anchor">#</a> Mutation提交风格</h3> <p>Vue还提供了另外一种风格, 它是一个包含type属性的对象</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322172251.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322172144.png" alt=""></p> <p>界面显示效果也是一样的</p> <h2 id="mutation响应规则"><a href="#mutation响应规则" class="header-anchor">#</a> Mutation响应规则</h2> <p>Vuex的store中的state是响应式的, 当state中的数据发生改变时, Vue组件会自动更新.</p> <p>一开始在state里面定义的属性,都会被加入到响应式系统中,而响应式系统会监听属性的变化,当属性发生变化时,会通知所有界面中用到该属性的地方,让界面发生刷新</p> <p>当给state中的对象添加新属性时, 使用下面的方式:
方式一: 使用<code>Vue.set(obj, 'newProp', 123)</code>
方式二: 用新对象给旧对象重新赋值</p> <h2 id="mutation常量类型"><a href="#mutation常量类型" class="header-anchor">#</a> Mutation常量类型</h2> <p>在mutation中, 我们定义了很多事件类型(也就是其中的方法名称).
当我们的项目增大时, Vuex管理的状态越来越多, 需要更新状态的情况越来越多, 那么意味着Mutation中的方法越来越多.
方法过多, 使用者需要花费大量的经历去记住这些方法, 甚至是多个文件间来回切换, 查看方法名称, 甚至如果不是复制的时候, 可能还会出现写错的情况.</p> <p>创建一个文件: mutationstypes.js, 并且在其中定义我们的常量</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322183441.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322183318.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322183216.png" alt=""></p> <h2 id="mutations同步函数"><a href="#mutations同步函数" class="header-anchor">#</a> Mutations同步函数</h2> <p>通常情况下, Vuex要求我们Mutation中的方法必须是同步方法.
主要的原因是当我们使用devtools时, 可以devtools可以帮助我们捕捉mutation的快照.
但是如果是异步操作, 那么devtools将不能很好的追踪这个操作什么时候会被完成,比如settimeout,就是异步操作,实际上数据已经更改了,但是devtools的state数据还没更改.</p> <h2 id="actions"><a href="#actions" class="header-anchor">#</a> actions</h2> <p>我们强调, 不要再Mutation中进行异步操作.
但是某些情况, 我们确实希望在Vuex中进行一些异步操作, 比如网络请求, 必然是异步的.</p> <p>Action类似于Mutation, 但是是用来代替Mutation进行异步操作的.</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322185845.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322190255.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322190718.png" alt=""></p> <p>context是和store对象具有相同方法和属性的对象.
也就是说, 我们可以通过context去进行commit相关的操作, 也可以获取context.state等.</p> <p>在Vue组件中, 如果我们调用action中的方法, 那么就需要使用dispatch</p> <h2 id="module"><a href="#module" class="header-anchor">#</a> Module</h2> <p>Module是模块的意思, 为什么在Vuex中我们要使用模块呢?</p> <p>Vue使用单一状态树,那么也意味着很多状态都会交给Vuex来管理.当应用变得非常复杂时,store对象就有可能变得相当臃肿.</p> <p>为了解决这个问题, Vuex允许我们将store分割成模块(Module), 而每个模块拥有自己的state、mutations、actions、getters等</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322232926.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322233637.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200322233843.png" alt=""></p> <h2 id="项目结构组织"><a href="#项目结构组织" class="header-anchor">#</a> 项目结构组织</h2> <p>当我们的Vuex帮助我们管理过多的内容时, 好的项目结构可以让我们的代码更加清晰.</p> <p><img src="https://cdn.jsdelivr.net/gh/zhongyongfeng/blogimg/img/20200323000734.png" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.da8279db.js" defer></script><script src="/assets/js/2.09c1df90.js" defer></script><script src="/assets/js/65.37f298d6.js" defer></script><script src="/assets/js/3.c0db3266.js" defer></script>
  </body>
</html>
